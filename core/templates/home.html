<!-- dashboard.html -->
{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}

{% load static %}

<!-- Dashboard -->
    <div class="max-w-7xl mx-auto grid grid-cols-12 h-32">
      <div class="col-span-12 lg:col-span-7 flex items-center px-4">
        <p class="text-3xl text-500">Dashboard | Event</p>
      </div>
      <div class="col-span-12 lg:col-span-5 flex items-center justify-center px-4">
        <a href="{% url 'event-create' %}" class="bg-orange-600 rounded-lg text-white text-xl py-2 px-5">Create Event</a>
      </div>
    </div>

  <!-- Main Container -->
  <div class="max-w-7xl mx-auto grid grid-cols-12 gap-6 pt-4">

    <!-- Left Section (8 columns) -->
    <div class="col-span-12 lg:col-span-8">


      <!-- Top Buttons -->
      <div class="p-4 rounded-xl flex gap-2 m-0">
        <a href="{% url 'events' %}" class="bg-gray-100 px-2 py-1 rounded-lg hover:bg-gray-200">All</a>
        <a href="{% url 'events' %}?type=today" class="bg-gray-100 px-2 py-1 rounded-lg hover:bg-gray-200">Today</a>
        <a href="{% url 'events' %}?type=upcoming" class="bg-gray-100 px-2 py-1 rounded-lg hover:bg-gray-200">Coming</a>
        <a href="{% url 'events' %}?type=recent" class="bg-gray-200 px-2 py-1 rounded-lg hover:bg-gray-200">Recent</a>
      </div>

      <!-- Events List -->
      <div class="bg-gray-300 p-4 rounded-xl space-y-4">
        <h2 class="text-2xl font-bold mb-2">Events</h2>

        {% for event in events %}
          <div class="bg-gray-200 p-3 rounded-lg grid grid-cols-12 gap-4">
            <div class="col-span-12 lg:col-span-5">
              <img src="{% static "images/events.jpg" %}" alt="Events Img" class="" >
            </div>
            <div class="col-span-12 lg:col-span-7 gap-2 mt-2 space-y-2">
              <h2 class="text-xl font-bold">Event Name: {{event.name}}</h2>
              <p class="text-md">Category: {{event.category.name}} </p>
              <p class="text-md">Date: {{event.date}}</p>
              <p class="text-md">Location: {{event.location}}</p>
              <p class="text-md">No of Participants: {{event.participant_count}}</p>
              <div class="mt-2 pt-4 flex gap-2">
                <a href="{% url 'details' event.id %}" class="bg-orange-600 rounded-lg text-white py-2 px-3">Details</a>
                <a href="{% url 'event-update' event.id %}" class="bg-orange-600 rounded-lg text-white py-2 px-3">Update</a>
                <form action="{% url 'event-delete' event.id %}" method="POST">
                  {% csrf_token %}
                  <button type="submit" class="bg-orange-600 rounded-lg text-white py-2 px-3">Delete</button>
                </form>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

    </div>

    <!-- Right Section (4 columns) -->
    <div class="col-span-12 lg:col-span-4 space-y-4">

      <div class="p-4 rounded-lg text-center bg-gray-300 p-4 rounded-xl space-y-4">
        <div class="bg-gray-300 p-4 rounded-xl space-y-4">
        <h2 class="text-lg mb-1">Search By Name</h2>
          <form method="GET" class="flex gap-2 mb-6 justify-center">
            <input type="text" name="name" value="{{ name_query }}"
                  placeholder="Search events..."
                  class="border px-3 py-2 w-64 rounded">
            <button class="bg-orange-600 text-white px-4 py-2 rounded">Search</button>
          </form>
        <h2 class="text-lg mb-1">Search By Category</h2>
        <form method="GET" class="flex gap-2 mb-6 justify-center">
          <input type="text" name="category" value="{{ cat_query }}"
                placeholder="Search category..."
                class="border px-3 py-2 w-64 rounded">
          <button class="bg-orange-600 text-white px-4 py-2 rounded">Search</button>
        </form>
        <h2 class="text-lg mb-1">Search By Date Range</h2>
        <form method="GET" class="mb-6">
          <input type="date" name="date_from" value="{{ date_from }}"
                class="border px-3 py-2 rounded">
          <input type="date" name="date_to" value="{{ date_to }}"
                class="border px-3 py-2 rounded">
          <button class="bg-orange-600 text-white px-4 py-2 rounded mt-3">Search</button>
        </form>
        </div>

      </div>
      <div class="p-4 rounded-lg text-center">
        <!-- Upcoming Events List -->
      <div class="bg-gray-300 p-4 rounded-xl space-y-4">
        <h2 class="text-xl font-bold mb-2">Upcoming Events</h2>

        <div class="bg-gray-200 p-3 rounded-lg flex justify-between">
          <div class="font-bold">Event Name</div>
          <div class="font-bold">Event Date</div>
        </div>
        {% for up_event in up_events %}
        <div class="bg-gray-200 p-3 rounded-lg flex justify-between">
          <div>{{up_event.name}}</div>
          <div>{{up_event.date}}</div>
        </div>
        {% endfor %}
      </div>
      </div>

    </div>

  </div>

    {% comment %} Messages Pop-Up Model {% endcomment %}
      {% if messages %}
    <div id="successModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
        <div class="bg-white rounded-lg shadow-lg p-6 w-80 text-center">
            <h2 class="text-xl font-semibold text-green-600 mb-3 flex">Success <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mt-1">
      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z" />
    </svg>
    </h2>

            {% for message in messages %}
                <p class="text-gray-700 mb-4">{{ message }}</p>
            {% endfor %}

            <button id="closeModal"
                class="mt-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                Close
            </button>
        </div>
    </div>

<script>
    // close button
    document.getElementById("closeModal").onclick = function () {
        document.getElementById("successModal").style.display = "none";
    };

    // click outside to close
    window.onclick = function(e){
        const modal = document.getElementById("successModal");
        if(e.target === modal){
            modal.style.display = "none";
        }
    };
</script>
{% endif %}

{% endblock %}
